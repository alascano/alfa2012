****Y2K****

PUBLIC TI1,TI2
IF C=TOPEC
   COLA=20
ENDIF   
IF MANUAL = 0
   DECLARE TABLA[07]
ENDIF
SET COLOR TO I
@ 05,COLA-2 CLEAR TO 23,COLA+30
@ 05,COLA-2 TO 23,COLA+30
@ 07,COLA-1 TO 07,COLA+29
@ 21,COLA-1 TO 21,COLA+29
@ 06,COLA SAY [ INDICES : ]
@ 22,COLA SAY [  INDEXANDO BASE  : ]
SET COLOR TO I
@ 08,COLA SAY [CLIENTES    ]
@ 10,COLA SAY [PROVEEDORES ]
@ 12,COLA SAY [VENDEDORES  ]
@ 14,COLA SAY [PRODUCTOS   ]
@ 16,COLA SAY [CONTABILIDAD]
@ 18,COLA SAY [BANCOS      ]
@ 20,COLA SAY [USUARIOS    ]
SET COLOR TO
Z = 8
X = COLA+14
FOR Q = 1 TO 7
    @ Z,X SAY SPACE(8)
    Z = Z + 2
NEXT
SET COLOR TO I,W+/R+
TOT = 2
@ 06,COLA+11 PROMPT "  TOTAL  "
@ 06,COLA+20 PROMPT " PARCIAL "
IF MANUAL = 1
   KEYBOARD CHR(13)
ENDIF
MENU TO TOT
IF LASTKEY() = 27
   RETURN
ENDIF
Z = 8
X = COLA+24
IF TOT = 2
   SET COLOR TO I,W+/R+
   FOR Q = 1 TO 7
       IF MANUAL = 1
          IF TABLA[Q] = 0
             SET COLOR TO W+/R+
             @ Z,X+0 SAY "NO"
             SET COLOR TO I
             @ Z,X+2 SAY "SI"
          ELSE
             SET COLOR TO I
             @ Z,X+0 SAY "NO"
             SET COLOR TO W+/R+
             @ Z,X+2 SAY "SI"
          ENDIF
       ELSE
          @ Z,X   PROMPT "NO"
          @ Z,X+2 PROMPT "SI"
          MENU TO ELE
          TABLA[Q] = ELE
       ENDIF
       Z = Z + 2
   NEXT
ELSE
   AFILL(TABLA,2)
ENDIF
SET COLOR TO R+
TI1="COD"
TI2="NOM"
IF TABLA[1] = 2
   IF PROFAAM=99999999
      DO ESPECIAL
   ENDIF
   INDEXAR(BTAR,08,COLA+14,ICTAR,TI1,INTAR,TI2)
   INDVENT(08,COLA+14,3)
   INDCTAS(08,COLA+14,1)
ENDIF
IF TABLA[2] = 2
   INDCOMP(10,COLA+14,3)
   INDCTAS(10,COLA+14,2)
ENDIF
IF TABLA[3] = 2
   INDCTAS(12,COLA+14,3)
   INDSTOC(12,COLA+14,3)
ENDIF
IF TABLA[4] = 2
   TI3 = "STR(PRO)+SUBS(NOM,1,10)"
   TI4 = "STR(TIP)+SUBS(NOM,1,10)"
   INDEXAR(BSTO,14,COLA+14,ICSTO,TI1,INSTO,TI2,IPSTO,TI3,ITSTO,TI4)
   TI4 = "ART"
   INDEXAR(BSTO,14,COLA+14,IASTO,TI4)
   INDEXAR(BTIP,14,COLA+14,ICTIP,TI1,INTIP,'NOM')
   INDEXAR(BCED,14,COLA+14,ICCED,TI1,INCED,'NOM')
ENDIF
IF TABLA[5] = 2
   INDCONT(16,COLA+14)
ENDIF
IF TABLA[6] = 2
   INDBANC(18,COLA+14)
ENDIF
IF TABLA[7] = 2
   INDPASW(20,COLA+14)
ENDIF
SET COLOR TO
RETURN

PROCEDURE ESPECIAL
USE &BCTC
REPL FVE WITH CTOD(SUBS(DTOC(FVE),1,6)+'2000') FOR YEAR(FVE)=1900
USE &BCTP
REPL FVE WITH CTOD(SUBS(DTOC(FVE),1,6)+'2000') FOR YEAR(FVE)=1900
USE &BLIB
REPL FCH WITH CTOD(SUBS(DTOC(FCH),1,6)+'2000'),FAC WITH FCH FOR YEAR(FCH)=1900
USE &BCHE
REPL FEM WITH CTOD(SUBS(DTOC(FEM),1,6)+'2000') FOR YEAR(FEM)=1900
REPL FEM WITH CTOD(SUBS(DTOC(FEM),1,6)+'2000') FOR YEAR(FEM)=1920
RETURN
